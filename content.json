{"meta":{"title":"陈浩的blog","subtitle":"Hello!欢迎访问我的blog，有问题可以私聊我，对我提建议也非常感谢。","description":"一个iOSdeveloper","author":"VasterChen","url":"http://mousechen.com"},"pages":[{"title":"404-找不到页面","date":"2016-09-03T09:17:18.000Z","updated":"2017-05-05T06:42:50.000Z","comments":false,"path":"404.html","permalink":"http://mousechen.com/404.html","excerpt":"","text":"因为期待得太苦，会导致得到的时候分外甜"},{"title":"about","date":"2016-09-03T15:42:06.000Z","updated":"2017-05-05T07:27:28.000Z","comments":false,"path":"about/index.html","permalink":"http://mousechen.com/about/index.html","excerpt":"","text":"联系方式Email:18758213012@163.com 基本信息学历：本科目前所在城市：杭州 个人简介目前为iOS工程师"},{"title":"categories","date":"2016-09-05T15:41:55.000Z","updated":"2017-05-05T06:31:54.000Z","comments":false,"path":"categories/index.html","permalink":"http://mousechen.com/categories/index.html","excerpt":"","text":"s"},{"title":"guestbook","date":"2016-09-03T09:21:10.000Z","updated":"2017-05-09T06:44:30.000Z","comments":true,"path":"guestbook/index.html","permalink":"http://mousechen.com/guestbook/index.html","excerpt":"","text":"认真的人才有资格开玩笑 如果有技术性的问题 欢迎给我留言，也可以直接私聊我"}],"posts":[{"title":"项目模块化之代码解耦 ","slug":"项目模块化之代码解耦","date":"2018-01-17T03:13:41.000Z","updated":"2018-01-17T07:00:36.101Z","comments":true,"path":"2018/01/17/项目模块化之代码解耦/","link":"","permalink":"http://mousechen.com/2018/01/17/项目模块化之代码解耦/","excerpt":"为什么要项目模块化？ 首先是因为出现了这个需求，我们是一个为医院提供服务的APP，但是某些医院希望使用某个单独功能 而并非全部，希望能够将单独功能打成一个APP，所以直接导致了这个项目的启动 其次是因为项目已经很大，模块间的耦合相对严重，修改一些东西 可能牵扯到很多其他地方，所以为了解耦，也促使了这次项目的推进","text":"为什么要项目模块化？ 首先是因为出现了这个需求，我们是一个为医院提供服务的APP，但是某些医院希望使用某个单独功能 而并非全部，希望能够将单独功能打成一个APP，所以直接导致了这个项目的启动 其次是因为项目已经很大，模块间的耦合相对严重，修改一些东西 可能牵扯到很多其他地方，所以为了解耦，也促使了这次项目的推进 怎么进行代码解耦呢？ 代买解耦最重要的就是减少类间的相互依赖，什么方法能最大程度的解耦呢？ 答案当然是runtime，因为runtime是利用字符串来获取类以及类中的属性，所以我们可以认为是毫无耦合性，当然runtime最大的缺点就是当我们修改某些类或者属性名称时，runtime并不会报错，但是流程却走不下去了，所以，如何处理好这些获取的属性的字符串 是非常重要的。 由于耦合基本只存在于控制器中，所以首要是解除控制器的耦合，怎么解呢？我们使用了路由跳转的方式，也就是通过类名来获取实例对象：123456789101112131415+(void)load&#123; static dispatch_once_t onceToken; dispatch_once(&amp;onceToken, ^&#123; NSLog(@&quot;%@&quot;,CLASS_URL); [NDJRouter registerURLPattern:CLASS_URL toObjectHandler:^id(NSDictionary *routerParameters) &#123; //初始化对象 id vc = [self new]; // configBlock中是对父控制器中控制传值和调用的block的注册 [vc configBlock]; return vc; &#125;]; &#125;);&#125; 我们利用了load在类加载的时候触发的特性，在其中通过类似网址的形式注册多个不同的blcok，一般是 1234//注册类的URL#define CLASS_URL [NSString stringWithFormat:@&quot;xxxx://%@/%@&quot;,[[[NSBundle mainBundle] infoDictionary] objectForKey:(NSString *)kCFBundleExecutableKey],NSStringFromClass(self)]//获取类得URL，每个类都可以这样写#define URL_FOR_CLASS(class) [NSString stringWithFormat:@&quot;ngariDoctor://%@/%@&quot;,[[[NSBundle mainBundle] infoDictionary] objectForKey:(NSString *)kCFBundleExecutableKey],(class)] 当我们需要某个类时，只需要利用1[NDJRouter objectForURL:URL_FOR_CLASS(@&quot;类名&quot;)] 因为这个时候回调block，初始化控制器对象并返回对象，就可以了。 那么如何传递参数呢 以及调用方法？我们在基础父类控制器的定义了几种block1234typedef void(^__returnBack)(NDBaseViewController *blockVC,id object);typedef void (^__setAttribute)(NSString*attributeName,...);typedef id (^__getAttribute)(NSString*attributeName) ;typedef id (^__fucntion)(NSString*funtionName,...) ; 第一种是用与回调的block，参数是当前控制器和需要回调的参数，用于替换掉所有的代理传值（因为代理传值耦合很大），第二种是利用属性名称传值，第三种是获取某个类得某个属性，第四种是调用方法具体使用方法就是这种： 12345678910BaseViewController *recipeDetailVC = [NDJRouter objectForURL:URL_FOR_CLASS(@&quot;NewRecipeInfoViewController&quot;)]; //赋值 recipeDetailVC.setAttribute(@&quot;recipeId&quot;,recipeId); //调用方法 recipeDetailVC.function(@&quot;loadWorkPlaceArray&quot;); recipeDetailVC.hidesBottomBarWhenPushed = YES; [self.fromViewController.navigationController pushViewController:recipeDetailVC animated:YES]; recipeDetailVC.returnBackBlock = ^(NDBaseViewController *blockVC, id object) &#123; //block回调之后需要做的操作 &#125;; 上面是block的回调，注册的时候就是在load方法中初始化对象的时候完成的","categories":[],"tags":[]},{"title":"关于copy协议中如何简便的为对象赋值","slug":"关于对象实现copy协议时属性赋值的问题","date":"2017-06-29T03:40:08.000Z","updated":"2017-06-29T03:50:22.000Z","comments":true,"path":"2017/06/29/关于对象实现copy协议时属性赋值的问题/","link":"","permalink":"http://mousechen.com/2017/06/29/关于对象实现copy协议时属性赋值的问题/","excerpt":"我们经常会遇到这一种情况：在界面push的时候会将这个界面的值传到下个界面，一般情况下使用vc.model = self.model没任何问题，但是有一种情况下就是当传值得时候会改变vc的一些属性的值，但是这个时候 ，由于self.model与vc.model指向同一个对象，会让self.model跟着改变，那当我们pop会这个界面时 ，想在做一些操作的时候，发现与预期不符，那么怎么解决这个问题呢？ 这个时候我们就需要重新生成一个对象了，使用copy来实现，如果我们使用的是foundation框架的对象时候是直接可以的(比如NSArray,NSDictionary)，因为所有类都已经实现了NSCopying协议，当我们使用自己创建的类的时候，就需要自己来实现该协议了。具体怎么做呢？","text":"我们经常会遇到这一种情况：在界面push的时候会将这个界面的值传到下个界面，一般情况下使用vc.model = self.model没任何问题，但是有一种情况下就是当传值得时候会改变vc的一些属性的值，但是这个时候 ，由于self.model与vc.model指向同一个对象，会让self.model跟着改变，那当我们pop会这个界面时 ，想在做一些操作的时候，发现与预期不符，那么怎么解决这个问题呢？ 这个时候我们就需要重新生成一个对象了，使用copy来实现，如果我们使用的是foundation框架的对象时候是直接可以的(比如NSArray,NSDictionary)，因为所有类都已经实现了NSCopying协议，当我们使用自己创建的类的时候，就需要自己来实现该协议了。具体怎么做呢？ 实现NSCopying协议 &lt;p&gt;@interface RecipeDetailModel:BaseModel&lt;NSCopying&gt;&lt;/p&gt; 实现协议方法&lt;p&gt;-(id)copyWithZone:(NSZone *)zone{ RecipeDetailModel *model = [[[self class] allocWithZone:zone]init]; return model;} &lt;/p&gt; 当然因为是新开辟的对象 需要我们手动赋值，这个时候问题来了，如果属性过多，会这样: ，当然这样写也没问题，但是作为一个以写简洁代码为目标的我（和很多程序员）忍不了，所以我开始思考有没有其他方式 结果想到的就是利用runtime来实现，通过class_copyPropertyList来获取该类所有属性，然后for循环来赋值： ，for循环中先获取属性名称，利用kvc来为对象赋值，因为model对象与self对象有相同属性，所以可以完全赋值","categories":[{"name":"技术","slug":"技术","permalink":"http://mousechen.com/categories/技术/"}],"tags":[{"name":"iOS","slug":"iOS","permalink":"http://mousechen.com/tags/iOS/"}]},{"title":"如何做到模块化代码","slug":"如何做到模块化代码","date":"2017-06-01T07:51:22.000Z","updated":"2017-06-01T07:57:22.000Z","comments":true,"path":"2017/06/01/如何做到模块化代码/","link":"","permalink":"http://mousechen.com/2017/06/01/如何做到模块化代码/","excerpt":"最近写代码遇到的一些思考 最近写代码的时候遇到一个问题 就是通过一个接口的两个不同的值来判断是否应该在底部显示两个按钮，这两个按钮是相互独立的 可能一个出现一个不出现 也可能两个同时出现 当时也没多想 就直接开始做了 发现事情远没有想的那么简单： 1. 首先，我在放置一个按钮的时候需要考虑 ，另一个按钮是否存在 以此来确定按钮的位置； 2. 另外 如果这个按钮不存在，那么，我需要判断另一个按钮是否存在，以此来判断是否需要设置tableview的偏移量（因为按钮存在的话 防止底部被遮挡)， 3. 对另一个按钮来说亦是如此，也需要判断。","text":"最近写代码遇到的一些思考 最近写代码的时候遇到一个问题 就是通过一个接口的两个不同的值来判断是否应该在底部显示两个按钮，这两个按钮是相互独立的 可能一个出现一个不出现 也可能两个同时出现 当时也没多想 就直接开始做了 发现事情远没有想的那么简单： 1. 首先，我在放置一个按钮的时候需要考虑 ，另一个按钮是否存在 以此来确定按钮的位置； 2. 另外 如果这个按钮不存在，那么，我需要判断另一个按钮是否存在，以此来判断是否需要设置tableview的偏移量（因为按钮存在的话 防止底部被遮挡)， 3. 对另一个按钮来说亦是如此，也需要判断。 虽然最后想了很久，也考虑了大部分情况，而且测试也没什么问题，但是心里写出了这些代码还是很不舒服，一是逻辑很多，二是觉得很小的一个东西不需要有这么多的代码，所以打算对这部分代码进行重构： 想法是首先确定需要创建哪些按钮，这些按钮用数组储存，然后根据这些元素来统一创建按钮，这样的话再创建一个按钮的时候就不需要来考虑其他按钮是否存在了！ 虽然是很小的问题，但是这其中包含了一种我写代码一直在追求的思想，即模块化，比如这件事情中的解决办法里 ，将原先的一块的代码里，分为两个模块，第一块来确定哪些按钮需要被创建，第二块是根据需要创建的按钮名称来创建按钮，而不是像以前一样一大块来判断并创建按钮，写两段代码的心情是完全不一样的，前者大脑疲惫，后者则充满了激动与开心，希望在今后写复杂代码的时候，也能够将这种思想带入进去，写出令自己开心的代码","categories":[{"name":"技术","slug":"技术","permalink":"http://mousechen.com/categories/技术/"}],"tags":[{"name":"iOS","slug":"iOS","permalink":"http://mousechen.com/tags/iOS/"}]},{"title":"“关于UISearchController的释放问题”","slug":"“关于UISearchController的释放问题”","date":"2017-05-04T02:55:23.000Z","updated":"2017-05-05T07:18:40.000Z","comments":true,"path":"2017/05/04/“关于UISearchController的释放问题”/","link":"","permalink":"http://mousechen.com/2017/05/04/“关于UISearchController的释放问题”/","excerpt":"####最近遇到一个问题：在APP做一些操作的时候回到首页时候会出现首页白屏问题 但是别人的电脑不会有这个问题，所以就没有在意，但是最近发现给别人安装测试包的时候手机上会出现，作为一个特大bug 但是只有我的电脑会复现，所以这个问题就落在我的身上，由于问题模糊，幸亏测试提供步骤复现bug，折腾了几天 终于找到问题并解决 现在来说说自己的思路####","text":"####最近遇到一个问题：在APP做一些操作的时候回到首页时候会出现首页白屏问题 但是别人的电脑不会有这个问题，所以就没有在意，但是最近发现给别人安装测试包的时候手机上会出现，作为一个特大bug 但是只有我的电脑会复现，所以这个问题就落在我的身上，由于问题模糊，幸亏测试提供步骤复现bug，折腾了几天 终于找到问题并解决 现在来说说自己的思路#### 1.首先弄明白为什么白屏，由于首页的显示是根据viewWillAppear中请求数据来显示的 所以猜想是该方法没有走，打断点在viewWillAppear以及viewWillDisAppear中 发现回到首页后 viewWillAppear走了，但是离开的时候viewWillDisAppear没走，所以回来的时候viewWillAppear也不会走，所以造成了白屏问题2.那么是什么造成的呢？一般道理的话不可能视图消失了viewWillDisAppear不走，因为复现bug的时候发现很多视图没有被释放，所以猜想是因为视图没释放造成遮盖造成viewWillDisAppear没有走（但是常理来说不管多少视图没释放也不应该会有这个问题，所以这也是只有的我的电脑会复现这个bug的原因）。3.接下来就是释放视图了，基本视图没释放都是因为与block进行了循环引用导致的，一步步的把所有的视图释放之后，之后发现UISearchController这个类有问题，因为只要有问题的时候会发现这个类都不会被释放，所以猜想是这个类造成的4.怎么证明是UISearchController的问题呢？ 我的做法是先利用UISearchBar代替UISearchController来走整个流程，发现不会出现问题，然后换回UISearchController，将UISearchController的view置灰，然后走流程，发现UISearchController全程在屏幕上并没有释放，但是不影响操作，所以现在大致确定问题了5.UISearchBar只是测试，不可能出现问题就替换掉的，所以还是要解决问题，怎么释放掉呢？做了很多操作，包括手动将controller置为nil，移除SearchBar第一响应者，但是不行，然后发现点击cancel按钮会释放，所以想法就是在页面跳转的时候在调一下系统的cancel方法，发现并没有什么卵用，反正就是试了各种方法6.解决办法：快放弃的时候发现UISearchController中有个active属性，当时抱着死马当活马医的心情，在跳转的时讲其置为NO ，发现竟然释放了。","categories":[{"name":"技术","slug":"技术","permalink":"http://mousechen.com/categories/技术/"}],"tags":[{"name":"iOS","slug":"iOS","permalink":"http://mousechen.com/tags/iOS/"}]},{"title":"获取Healthkit读写权限，让你的步数永远第一名","slug":"获取Healthkit读写权限，让你的步数永远第一名","date":"2017-04-14T08:54:28.000Z","updated":"2017-05-05T08:25:23.000Z","comments":true,"path":"2017/04/14/获取Healthkit读写权限，让你的步数永远第一名/","link":"","permalink":"http://mousechen.com/2017/04/14/获取Healthkit读写权限，让你的步数永远第一名/","excerpt":"最近闲来无事 发现iOS的步数与距离是可读写的 喜欢钻（装）研(比)的我立马开始研究了一下 历经三小时终于将原理搞清了大概 下面让我说一下自己的研究. 首先系统的东西，第一反应是先获取权限，这是苹果一惯的习(尿)惯(性),首先需要我们在plist文件添加两个权限 1、Privacy - Health Update Usage Description 后面为string类型 ，获取权 限说明2、Privacy - Health Share Usage Description 同上","text":"最近闲来无事 发现iOS的步数与距离是可读写的 喜欢钻（装）研(比)的我立马开始研究了一下 历经三小时终于将原理搞清了大概 下面让我说一下自己的研究. 首先系统的东西，第一反应是先获取权限，这是苹果一惯的习(尿)惯(性),首先需要我们在plist文件添加两个权限 1、Privacy - Health Update Usage Description 后面为string类型 ，获取权 限说明2、Privacy - Health Share Usage Description 同上 ​ 然后就是在Capabilities中将HealthKit打开(如果使用开发者证书需要勾选HealthKit 当然也可以不用证书，不过需要在账号中信任一下设备) 权限我们已经获取到了 那么接下来就是编码了，首先代码调取权限获取，接着获取步数与距离，然后添加步数与距离 就行了从方法可以很清楚看到我们需要做的步骤 1.获取权限2.获取系统现在的数据3.修改步数与公里数 现在代码已经完成，接下来就是show(装比)的时间了 ，修改步数（最好不要超过100000），接下面会发现系统的healthkit与QQ数据都改变了（但是支付宝竟然没有，不得不说很吊，其他的没有测试）,然后截图发朋友圈吧 哈哈哈。 PS：需要代码的请点击下载哦戳我传送","categories":[{"name":"技术","slug":"技术","permalink":"http://mousechen.com/categories/技术/"}],"tags":[{"name":"iOS","slug":"iOS","permalink":"http://mousechen.com/tags/iOS/"}]},{"title":"Hello World","slug":"hello-world","date":"2017-04-11T11:02:03.000Z","updated":"2017-04-11T11:02:03.000Z","comments":true,"path":"2017/04/11/hello-world/","link":"","permalink":"http://mousechen.com/2017/04/11/hello-world/","excerpt":"","text":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new \"My New Post\" More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment","categories":[],"tags":[]}]}